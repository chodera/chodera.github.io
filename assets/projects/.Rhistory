separate(display_name, into = "key", ",", extra = "drop") %>%
mutate(key = str_replace(key, "Kléber", "Kleber "),
key = str_replace(key, "Marché-Neudorf", "Marche Neudorf"),
key = str_replace(key, "é", "e"))
marche_stras <- marche_stras %>%
separate(location, into = "key", ",", extra = "drop")
# Merge data
marche_stras_full <- left_join(marche_stras, df_raw, by = "key") %>%
distinct() %>%
select(-key)
# Add location for "Place du Corps de Garde" manually (not found by nominatim)
marche_stras_full$lat[is.na(marche_stras_full$lat)] <- 48.6000378
marche_stras_full$lon[is.na(marche_stras_full$lon)] <- 7.7801695
# Create column indicating food market
marche_stras_full <- marche_stras_full %>%
mutate(food = ifelse(str_detect(name, "livres|fleurs|Brocante"), FALSE, TRUE))
View(marche_stras_full)
marche_stras_full <- df %>%
filter(str_detect(day, ".*"))
marche_stras_full %>%
filter(str_detect(day, ".*"))
marche_stras_full %>%
filter(str_detect(day, ".*")) %>%
filter(food == TRUE)
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
?leafletProxy
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
library(shinyWidgets)
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
str_detect(marche_stras_full$name)
str_detect(marche_stras_full$name, "livres")
runApp('10_marches_strasbourg/marche-app')
# Define icons
basket <- awesomeIcons(
icon = 'shopping-basket',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
)
book <- awesomeIcons(
icon = 'book',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
)
flower <- awesomeIcons(
icon = 'ios-rose',
iconColor = 'white',
library = 'ion',
markerColor = "green"
)
brocante <- awesomeIcons(
icon = 'shopping-bag',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
)
# User interface ----
ui <- bootstrapPage(
tags$head(
tags$style(HTML("
@import url('//fonts.googleapis.com/css?family=Oswald|Merriweather');
p {
font-family: 'Merriweather', serif;
}
"))
),
tags$style("#Id004, #var {font-family: 'Merriweather', serif;}"),
tags$style(type='text/css',
".selectize-input {font-family:'Merriweather', serif;}
text {font-family: 'Merriweather', serif}
.selectize-dropdown {font-family:'Merriweather', serif;"),
tags$head(tags$style(
HTML('
#sidebar {
background-color: white;
border-color: white;
}'),
tags$head(
tags$style(type="text/css", "text {font-family: 'Merriweather', serif}")
)
)),
tags$style(type = "text/css", "html, body {width:100%;height:100%}"),
leafletOutput("map", width = "100%", height = "100%"),
absolutePanel(top = 10, right = 10,
selectInput(inputId = "jours",
label = "",
choices = list(
"Tous les jours",
"Jour de la semaine" = c("Lundi",
"Mardi",
"Mercredi",
"Jeudi",
"Vendredi",
"Samedi") # end vector
) # end list
),
prettyCheckbox("food", "Uniquement alimentation", FALSE, icon = icon("check")) # end selectInput
) # end absolutePanel
) # end bootstrapPage
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
# Plot data
## Define map
map <- leaflet(marche_stras_full) %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addMarkers(
lng = ~lon,
lat = ~lat,
popup = ~name
)
## Show map
map
# Plot data
## Define map
map <- leaflet(marche_stras_full) %>%
#addProviderTiles(providers$CartoDB.Positron) %>%
addTiles() %>%
addMarkers(
lng = ~lon,
lat = ~lat,
popup = ~name
)
## Show map
map
basket <- awesomeIcons(
icon = 'shopping-basket',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
)
book <- awesomeIcons(
icon = 'book',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
)
flower <- awesomeIcons(
icon = 'ios-rose',
iconColor = 'white',
library = 'ion',
markerColor = "green"
)
brocante <- awesomeIcons(
icon = 'shopping-bag',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
)
## Define map
map <- leaflet(marche_stras_full) %>%
#addProviderTiles(providers$CartoDB.Positron) %>%
addTiles() %>%
addMarkers(
lng = ~lon,
lat = ~lat,
popup = ~name
)
## Define map
map <- leaflet(marche_stras_full) %>%
#addProviderTiles(providers$CartoDB.Positron) %>%
addTiles() %>%
addMarkers(
lng = ~lon,
lat = ~lat,
popup = ~name,
icon = basket
)
## Show map
map
## Define map
map <- leaflet(marche_stras_full) %>%
#addProviderTiles(providers$CartoDB.Positron) %>%
addTiles() %>%
addMarkers(
lng = ~lon,
lat = ~lat,
popup = ~name,
icon = basket
)
## Show map
map
## Define map
map <- leaflet(marche_stras_full) %>%
#addProviderTiles(providers$CartoDB.Positron) %>%
addTiles() %>%
addAwesomeMarkers(
lng = ~lon,
lat = ~lat,
popup = ~name,
icon = basket
)
## Show map
map
# Create column for markers
marche_stras_full <- marche_stras_full %>%
mutate(type = factor(
ifelse(str_detect(marche_stras_full, "livres"), "book", "basket"),
c("book", "basket")))
# Create column for markers
marche_stras_full <- marche_stras_full %>%
mutate(type = factor(
ifelse(str_detect(name, "livres"), "book", "basket"),
c("book", "basket")))
View(marche_stras_full)
basket <- awesomeIcons(
icon = 'shopping-basket',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
)
book <- awesomeIcons(
icon = 'book',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
)
flower <- awesomeIcons(
icon = 'ios-rose',
iconColor = 'white',
library = 'ion',
markerColor = "green"
)
brocante <- awesomeIcons(
icon = 'shopping-bag',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
)
## Define map
map <- leaflet(marche_stras_full) %>%
#addProviderTiles(providers$CartoDB.Positron) %>%
addTiles() %>%
addAwesomeMarkers(
lng = ~lon,
lat = ~lat,
popup = ~name,
icon = basket
)
## Show map
map
## Define map
map <- leaflet(marche_stras_full) %>%
#addProviderTiles(providers$CartoDB.Positron) %>%
addTiles() %>%
addAwesomeMarkers(
lng = ~lon,
lat = ~lat,
popup = ~name,
icon = ~type
)
## Define map
map <- leaflet(marche_stras_full) %>%
#addProviderTiles(providers$CartoDB.Positron) %>%
addTiles() %>%
addAwesomeMarkers(
lng = ~lon,
lat = ~lat,
popup = ~name,
icon = ~type
)
## Define map
map <- leaflet(marche_stras_full) %>%
#addProviderTiles(providers$CartoDB.Positron) %>%
addTiles() %>%
addAwesomeMarkers(
lng = ~lon,
lat = ~lat,
popup = ~name,
icon = ~ifelse(type == "book", book, basket)
)
## Show map
map
## Define map
map <- leaflet(marche_stras_full) %>%
#addProviderTiles(providers$CartoDB.Positron) %>%
addTiles() %>%
addAwesomeMarkers(
lng = ~lon,
lat = ~lat,
popup = ~name,
icon = ~ifelse(type == "book", book, basket)
)
## Show map
map
marketIcons <- iconList(
basket <- awesomeIcons(
icon = 'shopping-basket',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
),
book <- awesomeIcons(
icon = 'book',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
),
flower <- awesomeIcons(
icon = 'ios-rose',
iconColor = 'white',
library = 'ion',
markerColor = "green"
),
brocante <- awesomeIcons(
icon = 'shopping-bag',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
)
)
marketIcons <- awesomeIconList(
basket <- awesomeIcons(
icon = 'shopping-basket',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
),
book <- awesomeIcons(
icon = 'book',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
),
flower <- awesomeIcons(
icon = 'ios-rose',
iconColor = 'white',
library = 'ion',
markerColor = "green"
),
brocante <- awesomeIcons(
icon = 'shopping-bag',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
)
)
marketIcons <- awesomeIconList(
basket <- makeAwesomeIcon(
icon = 'shopping-basket',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
),
book <- makeAwesomeIcon(
icon = 'book',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
),
flower <- makeAwesomeIcon(
icon = 'ios-rose',
iconColor = 'white',
library = 'ion',
markerColor = "green"
),
brocante <- makeAwesomeIcon(
icon = 'shopping-bag',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
)
)
## Define map
map <- leaflet(marche_stras_full) %>%
#addProviderTiles(providers$CartoDB.Positron) %>%
addTiles() %>%
addAwesomeMarkers(
lng = ~lon,
lat = ~lat,
popup = ~name,
icon = ~marketIcons[type]
)
## Show map
map
marketIcons <- awesomeIconList(
basket = makeAwesomeIcon(
icon = 'shopping-basket',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
),
book = makeAwesomeIcon(
icon = 'book',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
),
flower = makeAwesomeIcon(
icon = 'ios-rose',
iconColor = 'white',
library = 'ion',
markerColor = "green"
),
brocante = makeAwesomeIcon(
icon = 'shopping-bag',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
)
)
## Define map
map <- leaflet(marche_stras_full) %>%
#addProviderTiles(providers$CartoDB.Positron) %>%
addTiles() %>%
addAwesomeMarkers(
lng = ~lon,
lat = ~lat,
popup = ~name,
icon = ~marketIcons[type]
)
## Show map
map
?case_when
# Create column for markers
marche_stras_full <- marche_stras_full %>%
mutate(type = factor(
case_when(str_detect(name, "livres") ~ "book",
str_detect(name, "fleurs") ~ "flower",
str_detect(name, "brocante") ~ "brocante",
str_detect(name, ".*") ~ "basket"),
c("book", "flower", "brocante", "basket")))
# Create column for markers
marche_stras_full <- marche_stras_full %>%
mutate(type = factor(
case_when(str_detect(name, "livres") ~ "book",
str_detect(name, "fleurs") ~ "flower",
str_detect(name, "brocante") ~ "brocante",
str_detect(name, ".*") ~ "basket"),
c("book", "flower", "brocante", "basket")))
View(marche_stras_full)
# Create column for markers
marche_stras_full <- marche_stras_full %>%
mutate(type = factor(
case_when(str_detect(name, "livres") ~ "book",
str_detect(name, "fleurs") ~ "flower",
str_detect(name, "Brocante") ~ "brocante",
str_detect(name, ".*") ~ "basket"),
c("book", "flower", "brocante", "basket")))
marketIcons <- awesomeIconList(
basket = makeAwesomeIcon(
icon = 'shopping-basket',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
),
book = makeAwesomeIcon(
icon = 'book',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
),
flower = makeAwesomeIcon(
icon = 'ios-rose',
iconColor = 'white',
library = 'ion',
markerColor = "green"
),
brocante = makeAwesomeIcon(
icon = 'shopping-bag',
iconColor = '#ffffff',
library = 'fa',
markerColor = "green"
)
)
## Define map
map <- leaflet(marche_stras_full) %>%
#addProviderTiles(providers$CartoDB.Positron) %>%
addTiles() %>%
addAwesomeMarkers(
lng = ~lon,
lat = ~lat,
popup = ~name,
icon = ~marketIcons[type]
)
## Show map
map
# Create column for markers
marche_stras_full <- marche_stras_full %>%
mutate(type = factor(
case_when(str_detect(name, "livres") ~ "book",
str_detect(name, "fleurs") ~ "flower",
str_detect(name, "Brocante") ~ "brocante",
str_detect(name, ".*") ~ "basket"),
c("book", "flower", "brocante", "basket")))
# Save data set
write_rds(marche_stras_full, "10_marches_strasbourg/marche_stras.rds")
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
runApp('10_marches_strasbourg/marche-app')
